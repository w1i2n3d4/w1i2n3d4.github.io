<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>鹏城杯2023-复现 | yolo</title><meta name="author" content="ahu"><meta name="copyright" content="ahu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="人生如逆旅，我亦是行人。">
<meta property="og:type" content="article">
<meta property="og:title" content="鹏城杯2023-复现">
<meta property="og:url" content="https://hucongting.com/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="yolo">
<meta property="og:description" content="人生如逆旅，我亦是行人。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hucongting.com/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/img/category_img.jpg">
<meta property="article:published_time" content="2023-11-14T07:06:55.000Z">
<meta property="article:modified_time" content="2023-11-14T15:21:32.429Z">
<meta property="article:author" content="ahu">
<meta property="article:tag" content="剪枝、深搜">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hucongting.com/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/img/category_img.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hucongting.com/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '鹏城杯2023-复现',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-14 23:21:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/img/nailong.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https:img/category_img.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="yolo"><span class="site-name">yolo</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">鹏城杯2023-复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-14T07:06:55.000Z" title="发表于 2023-11-14 15:06:55">2023-11-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-14T15:21:32.429Z" title="更新于 2023-11-14 23:21:32">2023-11-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WP/">WP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="鹏城杯2023-复现"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>参考：<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/e872e217.html#more">2023-鹏城杯-wp-crypto-糖醋小鸡块的blog</a></p>
<p>​ <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg5OTkxMzM3NA==&amp;mid=2247485180&amp;idx=1&amp;sn=4d0cb22e7e3b758f611540dc488f246f&amp;chksm=c04d450df73acc1b9215e87374570267fc643d1a320fa76dfe49502bbdb053a0ba9f4ad564bf&amp;scene=132&amp;exptype=timeline_recommend_article_extendread_samebiz#wechat_redirect">2023
鹏程杯-Van1sh</a></p>
<h1 id="leakyrsa">LeakyRSA</h1>
<h2 id="附件">附件</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">nbits=512</span><br><span class="line">p=getPrime(nbits)</span><br><span class="line">q=getPrime(nbits)</span><br><span class="line"></span><br><span class="line">leakBits = 262</span><br><span class="line">leak = (p ^ q)  &gt;&gt; (nbits - leakBits)</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">e=65537</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">print(&quot;n=%d&quot; %n)</span><br><span class="line">print(&quot;c=%d&quot; %c)</span><br><span class="line">print(&quot;leak=%d&quot; %leak)</span><br><span class="line"># n=73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br><span class="line"># leak=2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br><span class="line"># c=71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="解题思路">解题思路</h2>
<p>先回顾一下菜鸡本人赛时的思路。看到<code>p^q</code>让我想到了<code>2023年陕西省赛</code>中的<code>奇怪的sar</code><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74345946/article/details/131155838">2023陕西省赛-Crypto</a>。当时不知道<code>剪枝</code>，只知道是<code>关联爆破</code>，套用大佬的脚本，恢复一部分<code>p</code>高位。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52640415/article/details/130415368">关联爆破-RSA分解</a></p>
<p>这里 <code>print(tp)</code> 输出12个数据，前6个数的高位就是对应 p
的高位，后6个的高位就是对应 q 的高位</p>
<p>之后<code>爆破4位</code>即可 <code>copper</code>
恢复<code>p</code></p>
<p>赛后从大佬处学习到<code>剪枝深搜</code>，浅浅记录一下吧。</p>
<p>给了<code>p^q</code>的高位，要恢复<code>p,q</code></p>
<p><span class="math inline">\(\bullet\)</span>从高位开始搜索，对于每一位<code>leak</code>的值，<code>p,q</code>有四种可能:<code>[0,0],[0,1],[1,0],[1,1]</code>.</p>
<p><span class="math inline">\(\bullet\)</span>对于已恢复的<code>p,q</code>高位，其余位<code>(512-len(p))</code>都补<code>0</code>,乘积应该小于<code>n</code>;其余位都补<code>1</code>,乘积应该大于<code>n</code>.</p>
<p><span class="math inline">\(\bullet\)</span><code>p,q</code>两数之间必有一个数大，一个数小。这里假设<code>p&gt;q</code>,这样能<code>减小一半复杂度</code>。</p>
<p>深搜得到多个数据，运用<code>copper</code>恢复<code>p</code>。这里直接<code>copper</code>有点困难，<code>爆破4位</code></p>
<h2 id="菜鸡本人的exp">菜鸡本人的exp</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">N=73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br><span class="line">gift=2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br><span class="line">gift = gift&lt;&lt;250</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">ok = False</span><br><span class="line">def pq_xor(tp,tq,idx):</span><br><span class="line">    global ok </span><br><span class="line">    </span><br><span class="line">    if ok:</span><br><span class="line">        return </span><br><span class="line">    if tp*tq&gt;N:</span><br><span class="line">        return </span><br><span class="line">    if (tp+(2&lt;&lt;idx))*(tq+(2&lt;&lt;idx))&lt;N:</span><br><span class="line">        return </span><br><span class="line">        </span><br><span class="line">    if idx&lt;=250:</span><br><span class="line">        print(tp)</span><br><span class="line">        try:</span><br><span class="line">            f = tp + x </span><br><span class="line">            rr = f.monic().small_roots(X=2^250, beta=0.4,epsilon=0.01)</span><br><span class="line">            if rr != []:</span><br><span class="line">                print(rr)</span><br><span class="line">                print(tp)</span><br><span class="line">                print(&#x27;p = &#x27;,f(rr[0]))</span><br><span class="line">                ok = True</span><br><span class="line">                return</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        </span><br><span class="line">        return</span><br><span class="line">    </span><br><span class="line">    idx -=1</span><br><span class="line">    b = (gift &gt;&gt;idx)&amp;1</span><br><span class="line">    </span><br><span class="line">    one = 1&lt;&lt;idx </span><br><span class="line">    if b==0:</span><br><span class="line">        pq_xor(tp,tq,idx)  </span><br><span class="line">        pq_xor(tp+one,tq+one,idx)    </span><br><span class="line">    else:   #1</span><br><span class="line">        pq_xor(tp+one,tq,idx)</span><br><span class="line">        pq_xor(tp,tq+one,idx)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">#N.nbits()=2048 gift.nbits()=1023  p,q的1024位为1</span><br><span class="line">tp = 1&lt;&lt;511</span><br><span class="line">tq = 1&lt;&lt;511</span><br><span class="line">pq_xor(tp,tq,511)</span><br></pre></td></tr></table></figure>
<p>爆破<code>4位</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n = 73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br><span class="line">p_ = 10833217580503000698385694268032196544400600307706228180481286239545614448110771136511265552720079952935650128918955327972046701926479390396663939251306496</span><br><span class="line"></span><br><span class="line">p_high = p_ &gt;&gt; 252</span><br><span class="line">pbits = 512</span><br><span class="line">for i in range(2**4):</span><br><span class="line">     p4 = p_high&lt;&lt;4   </span><br><span class="line">     p4 = p4 + i</span><br><span class="line">     print(p4)</span><br><span class="line">    </span><br><span class="line">     kbits = pbits - p4.nbits()</span><br><span class="line">     p4 = p4 &lt;&lt; kbits</span><br><span class="line">     R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">     f = x + p4</span><br><span class="line">     x1 = f.small_roots(X=2^kbits, beta=0.4, epsilon=0.01)</span><br><span class="line">     if x1:</span><br><span class="line">         p = p4 + int(x1[0])</span><br><span class="line">         if p.nbits() == 512:</span><br><span class="line">                print(p)</span><br><span class="line">                break</span><br></pre></td></tr></table></figure>
<p>最后，常规<code>RSA</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n = ...</span><br><span class="line">p = ...</span><br><span class="line">q = n//p</span><br><span class="line">print(q)</span><br><span class="line">c=71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691</span><br><span class="line">d = gmpy2.invert(65537,(p-1)*(q-1))</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"># flag&#123;6eb67115-38b1-4e75-b3fc-de3a9697e565&#125;</span><br></pre></td></tr></table></figure>
<h2 id="学习大佬blog后的exp">学习大佬blog后的exp</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n = 73822410148110759760164946405270228269255384237831275745269402590230495569279769799226813942899942423718229747478982630879557319063920515141217164980012063064986634632452289290326704640527699568662492105204165609614169349755365956569362139057327962393611139347462018186440108621311077722819578905265976612923</span><br><span class="line">leak = 2223117424030234543005449667053988296724455736030907136592525175314696509716321</span><br><span class="line">c = 71808322808599218331233291542779486534747913572475630198802984648982830332628443972652322590637382696027943799004331488098592525306523343649935216419522329722152742610560398216737030893090641493326477786720839849938277402743820773957184083430369443325368720115515840174745825798187125454448297155036065857691</span><br><span class="line"></span><br><span class="line">nbits = 512</span><br><span class="line">kbits = 262</span><br><span class="line">leak = leak &lt;&lt; (nbits-kbits)</span><br><span class="line">s = str(bin(leak)[2:].rjust(nbits,&#x27;0&#x27;)) # 右对齐</span><br><span class="line"></span><br><span class="line">def find(p,q):</span><br><span class="line">    len_ = nbits - len(p)</span><br><span class="line">    # 每一位 leak 对应四种可能,其余位补0或1</span><br><span class="line">    temp0 = p + len_ * &#x27;0&#x27;</span><br><span class="line">    temp1 = p + len_ * &#x27;1&#x27;</span><br><span class="line">    temq0 = q + len_ * &#x27;0&#x27;</span><br><span class="line">    temq1 = q + len_ * &#x27;1&#x27;</span><br><span class="line"></span><br><span class="line">    if int(temp0,2) &gt; int(temq0,2): # p应该小于q</span><br><span class="line">        return</span><br><span class="line">    if int(temp0,2) * int(temq0,2) &gt; n:  # p,q其余位补0应该小于n</span><br><span class="line">        return</span><br><span class="line">    elif int(temp1,2) * int(temq1,2) &lt; n: # p,q其余位补1应该大于n</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    if(len(p) == kbits):  # p恢复到262位时打印出temp0</span><br><span class="line">        pp = int(temp0,2)</span><br><span class="line">        print(pp)</span><br><span class="line">    else:</span><br><span class="line">        if(s[len(p)] == &#x27;1&#x27;):  # leak当前位为1时，两种情况：[1,0],[0,1]，递归</span><br><span class="line">            find(p + &#x27;1&#x27;,q + &#x27;0&#x27;)</span><br><span class="line">            find(p + &#x27;0&#x27;,q + &#x27;1&#x27;)</span><br><span class="line">        else:                 # leak当前位为0时，两种情况：[0,0],[1,1]，递归</span><br><span class="line">            find(p + &#x27;0&#x27;,q + &#x27;0&#x27;)</span><br><span class="line">            find(p + &#x27;1&#x27;,q + &#x27;1&#x27;)</span><br><span class="line"></span><br><span class="line">p = &#x27;&#x27;</span><br><span class="line">q = &#x27;&#x27;</span><br><span class="line">find(p,q)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">10833217580503000698385694268032196544400600307706228180481286239545614448110771136511265552720079952935650128918955327972046701926479390396663939251306496</span><br><span class="line">10833217580503000698385694268032196544400600307706228180481286239545614448110769327259871219654526459639009368170395120628536301292666273871913815608655872</span><br><span class="line">10833217580503000698385694268032196544400600307706228180481286239545614448090869371173601831631653689887281894756674549357639729982197618145303870094442496</span><br><span class="line">10833217580503000698385694268032196544400600307706228180481286239545614448090797001117828509009513958021651464814266255617223704629672957155298924388417536</span><br><span class="line">10833217580503000698385694268032196544400600307706228180481286239545614448090795191866434175943960464725010704065706048273713303995859840630548800745766912</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># sage</span><br><span class="line">n = ...</span><br><span class="line">p_ = [...]  </span><br><span class="line">pbits = 512</span><br><span class="line">for j in range(len(p_)):</span><br><span class="line">    p_high = p_[j] &gt;&gt; 252</span><br><span class="line">    for i in range(2**4):</span><br><span class="line">        p4 = p_high&lt;&lt;4   </span><br><span class="line">        p4 = p4 + i</span><br><span class="line">        print(p4)</span><br><span class="line">    </span><br><span class="line">        kbits = pbits - p4.nbits()</span><br><span class="line">        p4 = p4 &lt;&lt; kbits</span><br><span class="line">        R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">        f = x + p4</span><br><span class="line">        x1 = f.small_roots(X=2^kbits, beta=0.4, epsilon=0.01)</span><br><span class="line">        if x1:</span><br><span class="line">            p = p4 + int(x1[0])</span><br><span class="line">            if p.nbits() == 512:</span><br><span class="line">                print(&#x27;p =&#x27;,p)</span><br><span class="line">                q = n // p</span><br><span class="line">                break</span><br><span class="line"># p = 10833217580503000698385694268032196544400600307706228180481286239545614448110770843300361411809086269809006469621399256214887200838529724133384063799751203         </span><br></pre></td></tr></table></figure>
<h1 id="secretshare">SecretShare</h1>
<h2 id="附件-1">附件</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import random </span><br><span class="line">from secret import flag, secret</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n = 21</span><br><span class="line">t = 21</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A = [secret]</span><br><span class="line">for i in range(n-1):</span><br><span class="line">    A.append(random.getrandbits(1024))</span><br><span class="line"></span><br><span class="line">X = []</span><br><span class="line">for i in range(n):</span><br><span class="line">    X.append(random.getrandbits(1024))</span><br><span class="line"></span><br><span class="line">p = getPrime(1026)</span><br><span class="line"></span><br><span class="line">def f(x):</span><br><span class="line">    res = 0</span><br><span class="line">    tmp = 1</span><br><span class="line">    for i in range(n):</span><br><span class="line">        res = (res + tmp * A[i]) % p </span><br><span class="line">        tmp = tmp * x % p</span><br><span class="line">    return res % p</span><br><span class="line"></span><br><span class="line">R = []</span><br><span class="line">for i in range(n):</span><br><span class="line">    R.append(f(X[i]))</span><br><span class="line"></span><br><span class="line">P = secret</span><br><span class="line">Q = getPrime(1024)</span><br><span class="line">N = P * Q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m, e, N)</span><br><span class="line">phi=(P - 1) * (Q - 1)</span><br><span class="line">d = pow(e,-1,phi)</span><br><span class="line">print(long_to_bytes(pow(c,d,N)))</span><br><span class="line"></span><br><span class="line">fi = open(&#x27;output.txt&#x27;,&#x27;w&#x27;)</span><br><span class="line">for i in range(t-1):</span><br><span class="line">    fi.write(str(X[i])+&#x27; &#x27;+str(R[i])+&#x27;\n&#x27;)</span><br><span class="line">print(&quot;leak = %d&quot;%R[-1])</span><br><span class="line">print(&quot;p = %d&quot;%p)</span><br><span class="line">print(&quot;c = %d&quot;%c)</span><br><span class="line">print(&quot;N = %d&quot;%N)</span><br><span class="line"></span><br><span class="line"># leak = 158171468736013100218170873274656605219228738469715092751861925345310881653082508445746109167302799236685145510095499361526242392251594397820661050281094210672424887670015189702781308615421102937559185479455827148241690888934661637911906309379701856488858180027365752169466863585611322838180758159364570481257</span><br><span class="line"># p = 667548632459029899397299221540978856425474915828934339291333387574324630349258515018972045406265448494845331262999241448002076917383740651362641947814545076390796789402373579283727117618532504865966299599663825771187433223531022829811594806917984414530614469374596457149431218829297339079019894262229453357029   </span><br><span class="line"># c = 9658009093151541277762773618550582280013680172161026781649630205505443184765264518709081169475689440555639354980432557616120809346519461077355134139495745998317849357705381020225760061125236265304057301286196004542729553944161451832173970613915423841610378207266606500956362098150141825329354727367056070349148059780287916811442861961254066733726576151134458892613951223277692935141880749737598416235307087782001086096114978527447987308876878393763055893556123029990282534497668077854186604106027698257663251502775547705641708624619340185646943640576690633662704397191379303254341343433077302686466850600522990402912</span><br><span class="line"># N = 11790604055677230214731474049594783873473779547159534481643303694816346271798870343160061559787963631020684982858033776446193418629055210874285696446209220404060653230407249409973790191858423402504530660556839353260629987853933304089439885784684686555554108157760445567974629355878575105480273451284714281430590737346099023372211403461861104391534461524711472734572409128196536805998116015230502045333769525693468193385557827209520108839913096017750428926467123493650506193757937746017474062985480713594474378324234033232933140389879312722642144536418253323908290256009510135710208223393009237664704631175216240376891</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="思路">思路</h2>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://hucongting.com">ahu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hucongting.com/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/">https://hucongting.com/2023/11/14/鹏城杯2023-复现/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hucongting.com" target="_blank">yolo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%89%AA%E6%9E%9D%E3%80%81%E6%B7%B1%E6%90%9C/">剪枝、深搜</a></div><div class="post_share"><div class="social-share" data-image="https:img/category_img.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/20/%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E9%87%91%E7%A0%962023%E7%BA%BF%E4%B8%8B%E8%B5%9B/" title="一带一路金砖2023线下赛"><img class="cover" src="/img/loading.gif" data-original="https:img/2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">一带一路金砖2023线下赛</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/01/DAS-CBCTF-2023%E5%A4%8D%E7%8E%B0/" title="DAS-CBCTF 2023复现"><img class="cover" src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">DAS-CBCTF 2023复现</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/nailong.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ahu</div><div class="author-info__description">希望和悲伤都是一缕光，总有一天，我们会再相遇。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/w1i2n3d4"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://githubfast.com/w1i2n3d4" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3235772652@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#leakyrsa"><span class="toc-number">1.</span> <span class="toc-text">LeakyRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">附件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="toc-number">1.2.</span> <span class="toc-text">解题思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8F%9C%E9%B8%A1%E6%9C%AC%E4%BA%BA%E7%9A%84exp"><span class="toc-number">1.3.</span> <span class="toc-text">菜鸡本人的exp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E5%A4%A7%E4%BD%ACblog%E5%90%8E%E7%9A%84exp"><span class="toc-number">1.4.</span> <span class="toc-text">学习大佬blog后的exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#secretshare"><span class="toc-number">2.</span> <span class="toc-text">SecretShare</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E4%BB%B6-1"><span class="toc-number">2.1.</span> <span class="toc-text">附件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">2.2.</span> <span class="toc-text">思路</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/20/%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E9%87%91%E7%A0%962023%E7%BA%BF%E4%B8%8B%E8%B5%9B/" title="一带一路金砖2023线下赛"><img src="/img/loading.gif" data-original="https:img/2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一带一路金砖2023线下赛"/></a><div class="content"><a class="title" href="/2023/11/20/%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E9%87%91%E7%A0%962023%E7%BA%BF%E4%B8%8B%E8%B5%9B/" title="一带一路金砖2023线下赛">一带一路金砖2023线下赛</a><time datetime="2023-11-20T01:45:34.000Z" title="发表于 2023-11-20 09:45:34">2023-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/" title="鹏城杯2023-复现"><img src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="鹏城杯2023-复现"/></a><div class="content"><a class="title" href="/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/" title="鹏城杯2023-复现">鹏城杯2023-复现</a><time datetime="2023-11-14T07:06:55.000Z" title="发表于 2023-11-14 15:06:55">2023-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/01/DAS-CBCTF-2023%E5%A4%8D%E7%8E%B0/" title="DAS-CBCTF 2023复现"><img src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DAS-CBCTF 2023复现"/></a><div class="content"><a class="title" href="/2023/11/01/DAS-CBCTF-2023%E5%A4%8D%E7%8E%B0/" title="DAS-CBCTF 2023复现">DAS-CBCTF 2023复现</a><time datetime="2023-11-01T06:41:32.000Z" title="发表于 2023-11-01 14:41:32">2023-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/28/ACTF-2023-WP/" title="ACTF 2023-WP"><img src="/img/loading.gif" data-original="https:img/12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ACTF 2023-WP"/></a><div class="content"><a class="title" href="/2023/10/28/ACTF-2023-WP/" title="ACTF 2023-WP">ACTF 2023-WP</a><time datetime="2023-10-28T12:48:32.000Z" title="发表于 2023-10-28 20:48:32">2023-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/19/%E9%9A%8F%E7%AC%94%E5%9B%9B/" title="随笔四"><img src="/img/loading.gif" data-original="https:img/1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="随笔四"/></a><div class="content"><a class="title" href="/2023/10/19/%E9%9A%8F%E7%AC%94%E5%9B%9B/" title="随笔四">随笔四</a><time datetime="2023-10-19T05:45:23.000Z" title="发表于 2023-10-19 13:45:23">2023-10-19</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https:img/category_img.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By ahu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>