<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2023 SICTF#Round 2 WP | yolo</title><meta name="author" content="ahu"><meta name="copyright" content="ahu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="心有海，静而不争">
<meta property="og:type" content="article">
<meta property="og:title" content="2023 SICTF#Round 2 WP">
<meta property="og:url" content="https://hucongting.com/2023/09/11/2023-SICTF-Round-2-WP/index.html">
<meta property="og:site_name" content="yolo">
<meta property="og:description" content="心有海，静而不争">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hucongting.com/2023/09/11/2023-SICTF-Round-2-WP/img/2.jpg">
<meta property="article:published_time" content="2023-09-11T08:31:09.000Z">
<meta property="article:modified_time" content="2023-09-13T02:06:35.201Z">
<meta property="article:author" content="ahu">
<meta property="article:tag" content="竞赛">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hucongting.com/2023/09/11/2023-SICTF-Round-2-WP/img/2.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hucongting.com/2023/09/11/2023-SICTF-Round-2-WP/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2023 SICTF#Round 2 WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-13 10:06:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/img/nailong.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https:img/2.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="yolo"><span class="site-name">yolo</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2023 SICTF#Round 2 WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-11T08:31:09.000Z" title="发表于 2023-09-11 16:31:09">2023-09-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-09-13T02:06:35.201Z" title="更新于 2023-09-13 10:06:35">2023-09-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AB%9E%E8%B5%9B/">竞赛</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2023 SICTF#Round 2 WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="radio">Radio</h2>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n1 = p * q</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n2 = p * q</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n3 = p * q</span><br><span class="line">e = 17</span><br><span class="line">c1 = pow(m,e,n1)</span><br><span class="line">c2 = pow(m,e,n2)</span><br><span class="line">c3 = pow(m,e,n3)</span><br><span class="line">print(&quot;n1 =&quot;,n1)</span><br><span class="line">print(&quot;n2 =&quot;,n2)</span><br><span class="line">print(&quot;n3 =&quot;,n3)</span><br><span class="line">print(&quot;c1 =&quot;,c1)</span><br><span class="line">print(&quot;c2 =&quot;,c2)</span><br><span class="line">print(&quot;c3 =&quot;,c3)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n1 = 14628911682936716611458501697007036859460044243525290515096052103585430459755335375005202100114469571371360084664887335211277585652711111523095037589648375630146039444071400098427638768750755153219974194380355807078158427824557754939604018020265955042573660474772006646525311705184431094905718137297923127124517126579859336516891364853724635334011666814712424599592662398013241607855160919361308195967978220182785816761656927836373944699635667244275310680450562446433724968942835275279255823144471582249379035668825437133182865600026935116686574740844588839352146024513673500770611055698030333734066230166111140083923 </span><br><span class="line">n2 = 16756694748293603983474688536179571665757862433174984877308316444468003022266277794769268134195205510197588585566270416339902269736376811449830775290335951504698137924773942880807921752691668522662285163130340474205633998154849689387759453003838730282756734975490180702422176361373516245372635401939755527017589503572550811648345570775428936487145892225736625411540461653083957762795820510109891180906709827194217045059033312564525916136573856999724346161896146703174418039344166251503310869772735585554127509732135494936119159784702673291794381095696332128950979288440758815310482211285712819274848744478643590996499 </span><br><span class="line">n3 = 12023158079717019193506148537498877243668782424904061914991928068483879707115315968983829360560644394409575645736275352836086080024994045582242629571839276759393418303915955798990522990081795218822313146157773272844272865701134880180795342597049645358985187689813369428579614193015028249821853347208001645148169449968882591709833452960545988520048722323580338213590245476892223967673180144525106292453573842357322398199104132677638909964034937501684668442732786408572501007756270725934445316827054687741612177409932320532825182104820899546084015733164816993674100635828218335112393003462442685677115798304835391938681 </span><br><span class="line">c1 = 786426913645332991929803636719878643130489430090701482974255190570111407517277263761161970232982615374753982050075781017755721714929721429185828101898786972242994012456972241276851428750970754773002966788642795040933520662931514953660571657013642671173456750800960592586345219252277575624120271330470724245201080094330964145796872211627254805407394764183615099525852600855622089361965086460279057625205099471122036599934609091062009161119885692567925924978687256063116915630947838112126347748759078024890458539541208153526564434483654508834147071166870006117573542198238493913144419569943131642262575848786399020602    </span><br><span class="line">c2 = 14269311999815379511888097227418748728398011595172649708273598243317106830139061994801598925448165045032084910971094414749744701731066555194159863759072739031915833091715422787808666326235589236328864675164322734119047182014621724868200908222400504845559290620275973427127376594365043386362821355037781568524903149101953873768462097165128186788759111090267131443645126715520994688945363059795513931799317608292977574376954729552861360597103229877031117089231816770880909815561950691603994439997197261395452797893557057320175747162837857668062550646101714062365530246698404923128445182100334335447738834779014705114350  </span><br><span class="line">c3 = 3204718091370324153305164801961074660508922478706979436653573192321723216725523523538914956544950802616295043619768261075799875855502834749045520466140056621489305006966280527055668378303630674311102581232313032585389907028715671091914904062961720585667564982641321454541632782484415075257140508738041786400512095949826279576159569786734978545737717138115729502475357594151593143140355121154223614868465202149338507796306863351134218879326031985027900678671697876083351974546516576983143592764763925335805465720148057651958521255276602933604064541840892578409973858867533575728482926007556060584654853884046046420855 </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong><span class="math inline">\(e=17\)</span>比较小，在相同<span class="math inline">\(e\)</span>的情况下对同一信息使用不同的模数<span class="math inline">\(n\)</span>进行<span class="math inline">\(RSA\)</span>加密，所以是低加密指数广播攻击。(核心是<span class="math inline">\(CRT\)</span></strong>)</p>
<p>实现低加密指数广播攻击需要满足以下三个条件：</p>
<p>（1）加密指数e非常小。
（2）同一份明文使用不同的模数n，相同的加密指数e进行多次加密。
（3）攻击者可以得到每一份加密后的密文和对应的模数n、加密指数e。</p>
<p>解题思路</p>
<p>运用中国剩余定理。</p>
<p>设正整数<span class="math inline">\(n _{1} , n _{2} , n
_{3},.......,n _{k}\)</span>两两互素,对任意整数<span class="math inline">\(c_{1},c_{2},c_{3},.......,c_{n}\)</span>,一次同余方程组
<span class="math display">\[
\left\{\begin{matrix} x &amp; \equiv &amp; c_{1} &amp; mod &amp; n_{1}\\
x&amp; \equiv &amp; c_{2} &amp; mod &amp;n_{2} \\ x&amp; \equiv &amp;
c_{3} &amp; mod &amp;n_{3} \\ ...&amp; &amp; &amp; &amp; \\ x&amp;\equiv
&amp;c_{n} &amp; mod &amp;n_{k} \end{matrix}\right.
\]</span></p>
<p>在模N意义下存在唯一解，该解可表示为: <span class="math display">\[
x\equiv
N_{1}*d_{1}*c_{1}+N_{2}*d_{2}*c_{2}+N_{3}*d_{3}*c_{3}+...N_{n}*d_{n}*c_{n}\mathbf{
}mod\mathbf{ }N
\]</span> 其中,<span class="math inline">\(n=n_{1}*n_{2}*n_{3}*...*n_{k}\)</span>,</p>
<p>​ <span class="math inline">\(N_{i}=N/n_{i}\)</span>,</p>
<p>​ <span class="math inline">\(d_{i}\equiv N_{i}^{-1}\textbf{
}mod\textbf{ }n_{i}\)</span></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from functools import reduce</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line"># 中国剩余定理</span><br><span class="line">def CRT(cipher, n):</span><br><span class="line">    N = reduce(lambda x, y: x * y, (i for i in n))</span><br><span class="line">    result = 0</span><br><span class="line">    data = zip(cipher, n)</span><br><span class="line">    for ci, ni in data:</span><br><span class="line">        Ni = N // ni</span><br><span class="line">        di = gmpy2.invert(Ni, ni)</span><br><span class="line">        result += ci * Ni * di</span><br><span class="line">    return result % N, N</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = 17</span><br><span class="line">c = [</span><br><span class="line">    786426913645332991929803636719878643130489430090701482974255190570111407517277263761161970232982615374753982050075781017755721714929721429185828101898786972242994012456972241276851428750970754773002966788642795040933520662931514953660571657013642671173456750800960592586345219252277575624120271330470724245201080094330964145796872211627254805407394764183615099525852600855622089361965086460279057625205099471122036599934609091062009161119885692567925924978687256063116915630947838112126347748759078024890458539541208153526564434483654508834147071166870006117573542198238493913144419569943131642262575848786399020602,</span><br><span class="line">    14269311999815379511888097227418748728398011595172649708273598243317106830139061994801598925448165045032084910971094414749744701731066555194159863759072739031915833091715422787808666326235589236328864675164322734119047182014621724868200908222400504845559290620275973427127376594365043386362821355037781568524903149101953873768462097165128186788759111090267131443645126715520994688945363059795513931799317608292977574376954729552861360597103229877031117089231816770880909815561950691603994439997197261395452797893557057320175747162837857668062550646101714062365530246698404923128445182100334335447738834779014705114350,</span><br><span class="line">    3204718091370324153305164801961074660508922478706979436653573192321723216725523523538914956544950802616295043619768261075799875855502834749045520466140056621489305006966280527055668378303630674311102581232313032585389907028715671091914904062961720585667564982641321454541632782484415075257140508738041786400512095949826279576159569786734978545737717138115729502475357594151593143140355121154223614868465202149338507796306863351134218879326031985027900678671697876083351974546516576983143592764763925335805465720148057651958521255276602933604064541840892578409973858867533575728482926007556060584654853884046046420855</span><br><span class="line">]</span><br><span class="line">n = [</span><br><span class="line">    14628911682936716611458501697007036859460044243525290515096052103585430459755335375005202100114469571371360084664887335211277585652711111523095037589648375630146039444071400098427638768750755153219974194380355807078158427824557754939604018020265955042573660474772006646525311705184431094905718137297923127124517126579859336516891364853724635334011666814712424599592662398013241607855160919361308195967978220182785816761656927836373944699635667244275310680450562446433724968942835275279255823144471582249379035668825437133182865600026935116686574740844588839352146024513673500770611055698030333734066230166111140083923,</span><br><span class="line">    16756694748293603983474688536179571665757862433174984877308316444468003022266277794769268134195205510197588585566270416339902269736376811449830775290335951504698137924773942880807921752691668522662285163130340474205633998154849689387759453003838730282756734975490180702422176361373516245372635401939755527017589503572550811648345570775428936487145892225736625411540461653083957762795820510109891180906709827194217045059033312564525916136573856999724346161896146703174418039344166251503310869772735585554127509732135494936119159784702673291794381095696332128950979288440758815310482211285712819274848744478643590996499,</span><br><span class="line">    12023158079717019193506148537498877243668782424904061914991928068483879707115315968983829360560644394409575645736275352836086080024994045582242629571839276759393418303915955798990522990081795218822313146157773272844272865701134880180795342597049645358985187689813369428579614193015028249821853347208001645148169449968882591709833452960545988520048722323580338213590245476892223967673180144525106292453573842357322398199104132677638909964034937501684668442732786408572501007756270725934445316827054687741612177409932320532825182104820899546084015733164816993674100635828218335112393003462442685677115798304835391938681</span><br><span class="line">    ]</span><br><span class="line">x, N = CRT(c, n)</span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(gmpy2.mpz(x), e)[0]</span><br><span class="line">print(m)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"># SICTF&#123;fdc0afb5-1c81-46b9-a28a-241f5f64419d&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mingtianpao">MingTianPao</h2>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import binascii</span><br><span class="line">from Crypto.Util.strxor import strxor</span><br><span class="line">from secret import flag, message</span><br><span class="line"># message is a Classic English Story</span><br><span class="line"></span><br><span class="line">for i in range(10):</span><br><span class="line">    tmp = (message[i*30:(i+1)*30].encode())</span><br><span class="line">    print(binascii.hexlify(strxor(tmp,flag)).decode())</span><br><span class="line"></span><br><span class="line"># 1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218</span><br><span class="line"># 3769373b66142f31297f291126410e042b01162d59103a0c005221075013</span><br><span class="line"># 37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e</span><br><span class="line"># 7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618</span><br><span class="line"># 7d69143c23156d18392b35183141310e3b49213613590003453a291a555d</span><br><span class="line"># 36273731341e297424372454230e0c0f2c49127f005f020245112718545d</span><br><span class="line"># 26396320295b2531227161273c04430f360d533118444e0f0b1d31554615</span><br><span class="line"># 323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19</span><br><span class="line"># 733e222766152220703e27063508074b300f53371e5d40444735291a555d</span><br><span class="line"># 37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d</span><br></pre></td></tr></table></figure>
<p>这是一个典型的<span class="math inline">\(MTP(Many-Time-Pad
)\)</span>问题。<strong>构造一个一定长度的密钥<span class="math inline">\(key\)</span>,让明文异或<span class="math inline">\(key\)</span>.解密是只需要让密文异或上<span class="math inline">\(key\)</span>就可以得到明文。这样在信息传输过程中就只需要传输一次密钥就可以，这样的加密方式就是<span class="math inline">\(Many-Time-Pad (MTP)\)</span></strong>.</p>
<p>在这个加密过程中，值得一提的是<strong>小写字母<span class="math inline">\(xor\)</span>空格得到对应的大写字母，大写字母<span class="math inline">\(xor\)</span>空格得到对应的小写字母，字母<span class="math inline">\(xor\)</span>字母<span class="math inline">\(!=\)</span> 字母</strong>.</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.ruanx.net/many-time-pad/">Many-Time-Pad</a></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import Crypto.Util.strxor as xo</span><br><span class="line">import libnum, codecs, numpy as np</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def isChr(x):</span><br><span class="line">    if ord(&#x27;a&#x27;) &lt;= x and x &lt;= ord(&#x27;z&#x27;): return True</span><br><span class="line">    if ord(&#x27;A&#x27;) &lt;= x and x &lt;= ord(&#x27;Z&#x27;): return True</span><br><span class="line">    return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def infer(index, pos):</span><br><span class="line">    if msg[index, pos] != 0:</span><br><span class="line">        return</span><br><span class="line">    msg[index, pos] = ord(&#x27; &#x27;)</span><br><span class="line">    for x in range(len(c)):</span><br><span class="line">        if x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(&#x27; &#x27;)</span><br><span class="line"></span><br><span class="line">def know(index, pos, ch):</span><br><span class="line">    msg[index, pos] = ord(ch)</span><br><span class="line">    for x in range(len(c)):</span><br><span class="line">        if x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line">def getSpace():</span><br><span class="line">    for index, x in enumerate(c):</span><br><span class="line">        res = [xo.strxor(x, y) for y in c if x!=y]</span><br><span class="line">        f = lambda pos: len(list(filter(isChr, [s[pos] for s in res])))</span><br><span class="line">        cnt = [f(pos) for pos in range(len(x))]</span><br><span class="line">        for pos in range(len(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c1 = [</span><br><span class="line">0x1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218,</span><br><span class="line">0x3769373b66142f31297f291126410e042b01162d59103a0c005221075013,</span><br><span class="line">0x37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e,</span><br><span class="line">0x7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618,</span><br><span class="line">0x7d69143c23156d18392b35183141310e3b49213613590003453a291a555d,</span><br><span class="line">0x36273731341e297424372454230e0c0f2c49127f005f020245112718545d,</span><br><span class="line">0x26396320295b2531227161273c04430f360d533118444e0f0b1d31554615,</span><br><span class="line">0x323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19,</span><br><span class="line">0x733e222766152220703e27063508074b300f53371e5d40444735291a555d,</span><br><span class="line">0x37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d</span><br><span class="line">]</span><br><span class="line">c = []</span><br><span class="line">for i in c1:</span><br><span class="line">    c.append(long_to_bytes(i))</span><br><span class="line"></span><br><span class="line"># c = [codecs.decode(x.strip().encode(), &#x27;hex&#x27;) for x in open(&#x27;Problem.txt&#x27;, &#x27;r&#x27;).readlines()]</span><br><span class="line">msg = np.zeros([len(c), len(c[0])], dtype=int)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = sorted(dat)[::-1]</span><br><span class="line">for w, index, pos in dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line">know(0,24,&#x27;r&#x27;)</span><br><span class="line">know(1,10,&#x27;h&#x27;)</span><br><span class="line">know(1,12,&#x27;r&#x27;)</span><br><span class="line">know(2,28,&#x27;d&#x27;)</span><br><span class="line">know(3,16,&#x27;o&#x27;)</span><br><span class="line"></span><br><span class="line">print(&#x27;\n&#x27;.join([&#x27;&#x27;.join([chr(c) for c in x]) for x in msg]))</span><br><span class="line"></span><br><span class="line">key = xo.strxor(c[0], &#x27;&#x27;.join([chr(c) for c in msg[0]]).encode())</span><br><span class="line">print(key)</span><br><span class="line"># SICTF&#123;MTP_AtTack_is_w0nderFu1&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">know(0,24,&#x27;r&#x27;)</span><br><span class="line">know(1,10,&#x27;h&#x27;)</span><br><span class="line">know(1,12,&#x27;r&#x27;)</span><br><span class="line">know(2,28,&#x27;d&#x27;)</span><br><span class="line">know(3,16,&#x27;o&#x27;)</span><br></pre></td></tr></table></figure>
<p>这里解释一下这一段代码，因为<strong>直接跑脚本恢复的明文中有一些单词并没有恢复完整，所以需要配合<span class="math inline">\(know()\)</span>将一些字母替换成正确的字母</strong>。要特别注意下标，很容易弄错。</p>
<p>另外，在做这一题之前，我做过一题类似的(当时不知道是<span class="math inline">\(MTP\)</span>),是用<span class="math inline">\(lingfeng\)</span>师傅的脚本做出来的。本次赛中尝试过那个脚本，无果。后来知道是这次<strong>数据太少，随机性太差</strong>。对本题稍加改动，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag = open(&#x27;flag.txt&#x27;,&#x27;rb&#x27;).read()</span><br><span class="line">assert flag.startswith(b&#x27;SICTF&#123;&#x27;) and flag.endswith(b&#x27;&#125;&#x27;)</span><br><span class="line">article = open(&#x27;article.txt&#x27;,&#x27;rb&#x27;).read()</span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">strxor = lambda x,y: bytes([a^b for a,b in zip(x,y)])</span><br><span class="line"></span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line">for i in range(100):</span><br><span class="line">    range_start = random.randint(0, len(article) - len(flag))</span><br><span class="line">    mask = article[range_start:range_start + len(flag)]</span><br><span class="line">    result.append(strxor(flag, mask))</span><br><span class="line"></span><br><span class="line">with open(&quot;result.log&quot;,&quot;w&quot;) as fs:</span><br><span class="line">    fs.writelines([str(i)+&quot;\n&quot; for i in result])</span><br></pre></td></tr></table></figure>
<p><span class="math inline">\(result.loog\)</span>文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">b&quot;=-c5f\x10(1&gt;1$\x07&#x27;A\x0c\r\x7f\x08\x03/\x05U\r\r\x04\x06/\x1a_]&quot;</span><br><span class="line">b&#x27;6**52\x1em&lt;5&gt;3\x1d:\x06OK0\x07\x1f&amp;WD\x06\x01E\x10*\x1c_\x19&#x27;</span><br><span class="line">b&#x27;s&gt;&amp;t.\x1a;1p*/\x00=\rC\x1c:I\x1f0\x04UN\r\x11^f\x1aW]&#x27;</span><br><span class="line">b&#x27;&lt;/c24\x1e(t=:/T#\t\x0cK7\x08\x05:WQN\x07\r\x1d/\x16TQ&#x27;</span><br><span class="line">b&quot;&gt;,c&#x27;2\t( 37$\x07t\x03\x06\r0\x1b\x16\x7f\x02CN\r\x0bR2\x1dT]&quot;</span><br><span class="line">b&#x27;7(:\&#x27;f\x089&amp;5+&quot;\x1ct\x0e\x16\x1f\x7f\x00\x1d\x7f\x16^N\x01\x0b\x16*\x10B\x0e&#x27;</span><br><span class="line">b&quot;;,c0&#x27;\x02&gt;t#+3\x11 \x02\x0bK0\x1c\x07\x7f\x1e^N\x05\x0bR#\x1bU\x11&quot;</span><br><span class="line">b&quot;6-c52[9&lt;5\x7f-\x15&#x27;\x15C\x066\x07\x06+\x12\x10\x0c\x1dE\x01)\x18T]&quot;</span><br><span class="line">b&#x27;s(-0f\x16&quot;:$72T5\x0f\x07K&amp;\x0c\x12-\x04\x10\x1a\x0bE\x11)\x18TS&#x27;</span><br><span class="line">b&quot;6i6&#x27;f\x12#t$7$T7\x0e\r\x18+\x08\x1d+W@\x0f\n\n\x00&#x27;\x18P]&quot;</span><br><span class="line">b&#x27;=i&quot;:&quot;[:=$7a\x18=\x15\x17\x07:I\x12/\x07B\x0b\x07\x0c\x132\x1c^\x13&#x27;</span><br><span class="line">b&#x27;s!&quot;0f\x14#8)\x7f T8\x08\x0e\x02+\x0c\x17\x7f\x16^\nD\x16\x02#\x16X\x1b&#x27;</span><br><span class="line">b&#x27;5i\xa1\xd4\xda&gt;, |\x7f%\x06=\x0f\x08G\x7f\x08\x1d;WR\x0bD\x08\x174\x07H\x9f&#x27;</span><br><span class="line">b&quot;2&#x27;&#x27;t.\x1e,&amp;91&amp;T=\x0fC\n;\x1c\x1f+W\\\x07\x02\x00\\f7D\t&quot;</span><br><span class="line">b&quot;s(/#&#x27;\x02&gt;t&#x27;:a\x031\x13\x06K6\x07\x07:\x05U\x1d\x10\x00\x16f\x1c_]&quot;</span><br><span class="line">b&quot;s&amp;%t0\x1a!!5,a\x1d&#x27;A\x00\x03&gt;\x07\x14:\x13\x1eN,\x00R$\x10R\x12&quot;</span><br><span class="line">b&#x27;$&amp;68&quot;[/1p&gt;a\x168\x04\x10\x186\x07\x14\x7f\x1eVN\x01\x04\x11.UY\x08&#x27;</span><br><span class="line">b&#x27; =&quot;zf(&quot;t\&#x27;:a\x13;A\x02\t0\x1c\x07\x7f\x18E\x1cD\x15\x172\x01H]&#x27;</span><br><span class="line">b&#x27;s/&amp;#f\x1f,-#\x7f \x00t\x12\x0c\x06:I\x076\x1aUN\x00\x10\x00/\x1bV]&#x27;</span><br><span class="line">b&#x27; i,2f\x1a=$&quot;:&quot;\x1d5\x15\n\x041I\x047\x1eS\x06D\x04\x00#U^\x1b&#x27;</span><br><span class="line">b&#x27;s-1=(\x10at11%T6\x04C\x06:\x1b\x01&amp;\x95\xb0\xf3JE03\x01\x11\x10&#x27;</span><br><span class="line">b&#x27; iq`f\x13&quot;!&quot;,oT\x16\x14\x17K&gt;\x05\x04&gt;\x0eCN\x13\x00R1\x10C\x18&#x27;</span><br><span class="line">b&quot;&#x27; 51f\x14+t$7$T9\x04\x02\x056\x07\x14\x7f\x18VN\x08\x0c\x14#UP\x13&quot;</span><br><span class="line">b&#x27;\x07!&amp;t&quot;\x1a4\&#x27;p,5\x061\x15\x00\x03\x7f\x06\x06+WY\x00D\x04\x1cf\x10_\x19&#x27;</span><br><span class="line">b&#x27;&#125;i\x0b1f\x19(7?2$\x07t\x0c\x0c\x19:I\x12/\x07B\x0b\x07\x0c\x132\x1cG\x18&#x27;</span><br><span class="line">b&quot;6**52\x12;1p0&#x27;T&#x27;\x08\x04\x03+RS,\x1e\\\x0b\n\x06\x17f\x02^\x08&quot;</span><br><span class="line">b&#x27;&lt;:&amp;t1\x13&quot;t8&gt;7\x11t\r\x0c\x18+I\x006\x10X\x1aD\x04\x1c&quot;UY\x18&#x27;</span><br><span class="line">b&#x27;6:0xf\r$3?-a\x15:\x05C\n\x7f\x02\x16:\x19^\x0b\x17\x16R)\x13\x11\x1c&#x27;</span><br><span class="line">b&#x27;; 0t#\x1a?8)\x7f \x10!\r\x17K3\x00\x15:Y\x10*\x05\x17\x19(\x10B\x0e&#x27;</span><br><span class="line">b&#x27;5i%&amp;#\x1em951a\x03&lt;\x0eC\x03&gt;\x1f\x16\x7f\x16\x10\r\x0c\n\x1b%\x10\x1d]&#x27;</span><br><span class="line">b&#x27;$,514Wm 14$T8\x08\x05\x0e\x7f\x0f\x1c-WW\x1c\x05\x0b\x06#\x11\x1f]&#x27;</span><br><span class="line">b&#x27;7,&quot; .U\x8f\xf4]U\x08\x1at\x12\x17\x04-\x00\x16,WD\x06\x01E\x16)\x1a\\\x18&#x27;</span><br><span class="line">b&#x27;6-mt\x11\x1em?&gt;06T \t\x02\x1f\x7f\x06\x1d:WT\x0f\x1dE\x05#U\\\x08&#x27;</span><br><span class="line">b&quot;!:&amp;xf\x14+t6-$\x11t\x0c\x06\x05\x7f\x1e\x1b0WX\x0f\x12\x00R&#x27;UR\x15&quot;</span><br><span class="line">b&quot;&amp;&#x27;&amp;xf\x198 p&gt;-\x19;\x12\x17K&gt;\x05\x04&gt;\x0eCN\x0c\x0c\x01f\x06T\x13&quot;</span><br><span class="line">b&#x27;2i(1#\x15#1#,a\x1b2A\x02\x1b/\x1b\x16&lt;\x1eQ\x1a\r\n\x1cf\x02Y\x14&#x27;</span><br><span class="line">b&#x27;%,c8/\r(0|\x7f(\x1at\x15\x0b\x0e\x7f\x1a\x1b&gt;\x13_\x19D\n\x14f\x11T\x1c&#x27;</span><br><span class="line">b&#x27;;(7t2\x13&quot;\&#x27;5\x7f6\x1c;A\x0f\x02)\x0c_\x7f\x18BN\x0c\x04\x04#U]\x14&#x27;</span><br><span class="line">b&#x27;293&amp;#\x18$5$67\x11t\x0e\x05K+\x01\x16\x7f\x1aU\x0f\n\x0c\x1c!U^\x1b&#x27;</span><br><span class="line">b&#x27;7&amp;m\x96\xe6vG\x19?,5T;\x07C\x1e,ES7\x18G\x0b\x12\x00\x00jUE\x1c&#x27;</span><br><span class="line">b&quot;!ec &#x27;\x10(t&lt;6&#x27;\x11t\x07\x0c\x19\x7f\x0e\x01&gt;\x19D\x0b\x00KR\x11\x10\x11\x16&quot;</span><br><span class="line">b&quot;&#x27;:c$#\t 5&gt;:/\x00t\x12\x13\x02-\x00\x07*\x16\\N\x12\x04\x1e3\x10BS&quot;</span><br><span class="line">b&#x27;&lt;;c&lt;/\x08m81,5T&lt;\x0e\x16\x19,GS\x16WC\x1e\x01\x04\x19jU^\x1b&#x27;</span><br><span class="line">b&#x27;2\&#x27;$1&quot;Um\x1c5\x7f#\x117\x0e\x0e\x0e,I\x1e0\x05UN\x05\x15\x024\x10R\x14&#x27;</span><br><span class="line">b&quot;s&#x27;, #\x1fm 8&gt;5T \t\x0c\x18:I\x047\x18\x10\x02\r\x13\x17jU^\x0f&quot;</span><br><span class="line">b&quot;&#x27;!c8/\x0f985\x7f \x04$\x13\x06\x086\x08\x076\x18^@D,\x06f\x1cB]&quot;</span><br><span class="line">b&#x27;2=+t$\t$:7\x7f T9\x04\x0f\x070\x1eS,\x00U\x0b\x10\x0b\x175\x06\x11\t&#x27;</span><br><span class="line">b&quot;&lt;$c9&#x27;\x10(t$7$T2\x14\x0f\x07:\x1a\x07\x7f\x02C\x0bD\n\x14f\x01Y\x18&quot;</span><br><span class="line">b&#x27; !&quot;0)\x0cm;6\x7f%\x115\x15\x0bK=\x1b\x1a1\x10\x10\x0fD\x08\x17*\x19^\n&#x27;</span><br><span class="line">b&#x27;6i,8&quot;[&gt; ?-8T;\x07C\x050\x1dS=\x12Y\x00\x03E\x154\x14E\x18&#x27;</span><br><span class="line">b&#x27;:=&amp;0f\x1a#0p,1\x117\x08\x05\x02:\rS+\x1e]\x0bD\x11\x1df\x19X\x0b&#x27;</span><br><span class="line">b&#x27; i4;3\x17)t=&gt;*\x11t\t\n\x06\x7f\x04\x1c-\x12\x10\x0f\x14\x15\x00#\x16X\x1c&#x27;</span><br><span class="line">b&#x27;6gc\x03#[&gt;&lt;?*-\x10t\r\n\x1d:I\x16&gt;\x14XN\x00\x04\x0bf\x02X\t&#x27;</span><br><span class="line">b&quot;:&#x27;7-f\x14+t921\x11:\x05\n\x058I\x17:\x16D\x06J\xa7\xd2K\x7fx\x13&quot;</span><br><span class="line">b&#x27;7i&quot;0)\x0b9t$7$T\x11\x11\n\x08*\x1b\x16&gt;\x19\x10\x03\x0b\x11\x06)U^\x1b&#x27;</span><br><span class="line">b&#x27;!:mt\x0f[&gt;$5&gt;*Xt\x0e\x05K&lt;\x06\x06-\x04UBD\n\x14f\x13C\x18&#x27;</span><br><span class="line">b&#x27; =,&amp;/\x1e&gt;t91a\x03&lt;\x08\x00\x03\x7f\x1d\x1b:WX\x0b\x16\nR.\x14U]&#x27;</span><br><span class="line">b&#x27;&#125;i\x10!%\x13m5&gt;\x7f \x00 \x08\x17\x1e;\x0cS(\x18E\x02\x00E\x17+\x05Y\x1c&#x27;</span><br><span class="line">b&#x27;&#125;\x8b\xe3YL2m&lt;1)$T;\x07\x17\x0e1I\x077\x18E\t\x0c\x11R/\x01\x11\n&#x27;</span><br><span class="line">b&#x27;?&gt;&quot;-5[:1p($\x061A\n\x05+\x0c\x01:\x04D\x0b\x00E\x1b(UU\x14&#x27;</span><br><span class="line">b&quot;6;75/\x159-p0&#x27;T=\x0c\x13\x0e1\r\x1a1\x10\x10\n\x01\x04\x06.[\xf3\xdd&quot;</span><br><span class="line">b&#x27;6:c=5[.&lt;11&amp;\x110OC#:I\x11:\x14_\x03\x01\x16R+\x1aC\x18&#x27;</span><br><span class="line">b&#x27;&lt;&lt;0t)\x1dm&lt;5&gt;-\x00&lt;A\x16\x05+\x00\x1f\x7f\x00UN\x05\x17\x17f\x1c]\x11&#x27;</span><br><span class="line">b&quot; &amp; =&#x27;\x0f$;&gt;,a\x07&lt;\x0e\x16\x07;I\x04:WS\x1c\x0b\x12\x16f\x1c_\t&quot;</span><br><span class="line">b&quot;s\x00c&lt;&#x27;\r(t$7.\x013\t\x17K6\x1dS(\x18E\x02\x00E\x10#UP\x13&quot;</span><br><span class="line">b&#x27;\x7fi!!2[,8=02\x00t\x00\x0f\x1c&gt;\x10\x00\x7f\x1fY\x1dD\x16\x17(\x06T]&#x27;</span><br><span class="line">b&#x27;s:+;4\x0fm5#\x7fs@t\t\x0c\x1e-\x1a]\x7f5E\x1aD\x04\x1e1\x14H\x0e&#x27;</span><br><span class="line">b&#x27;;,&quot;&amp;/\x15*xp0/\x18-A\x17\x03:I\x113\x1e^\nD\x17\x17\&#x27;\x19X\x07&#x27;</span><br><span class="line">b&#x27;s?&quot;83\x1e&gt;zp\x165T&lt;\x00\x10K0\x0f\x07:\x19\x10\x0c\x01\x00\x1cf\x1b^\t&#x27;</span><br><span class="line">b&#x27;s=+1f\x13(&amp;?\x7f)\x150A\x0c\x053\x10S&gt;W\\\x07\t\x0c\x06#\x11\x11\x1c&#x27;</span><br><span class="line">b&#x27;;i,!2[$:p&gt;/T1\x0f\x07\x07:\x1a\x00\x7f\x01Y\x1d\x10\x04\\f&amp;^]&#x27;</span><br><span class="line">b&#x27;2=c .\x1em81,5T9\x08\r\x1e+\x0cS=\x0e\x10\x1d\x0b\x08\x17f\x06E\x0f&#x27;</span><br><span class="line">b&quot;7i.;(\x0f%&#x27;p&gt;/\x10t\x18\x06\n-\x1aS+\x18\x10\r\x0b\x08\x17hUe\x15&quot;</span><br><span class="line">b&#x27;=-c&lt;/\x08m81,5T0\x00\x1a\x18\x7f\x06\x01\x7f\x1fY\x1dD\t\x135\x01\x11\x15&#x27;</span><br><span class="line">b&#x27;\&#x27;!&amp;-f\x1f&quot;z\x92\xffL~\x19\x0e\x10\x1f\x7f\x06\x15\x7f\x02CBD\r\x1d1\x10G\x18&#x27;</span><br><span class="line">b&#x27;6?&amp;&amp;?\x0f%=&gt;8a\x00&lt;\x04\x1aK;\x06]\x9d\xd7=d)\n\x012U^\x1b&#x27;</span><br><span class="line">b&#x27;6i&quot;&amp;#[9&lt;?,$Xt\x0e\x05K&lt;\x06\x06-\x04UBD\x12\x1a)UF\x12&#x27;</span><br><span class="line">b&#x27;s\x00c5+[,2&quot;&gt;(\x10xA\x00\x03&gt;\x1b\x12&lt;\x03U\x1c\r\x1f\x175UE\x15&#x27;</span><br><span class="line">b&#x27;s=&quot;?#[!=6:a\x12;\x13C\x0c-\x08\x1d+\x12T@D2\x17f\x1e_\x12&#x27;</span><br><span class="line">b&quot;&#125;i\n f\x13,&#x27;p0&#x27;\x001\x0fC\t:\x0c\x1d\x7f\x19_\x1a\x01\x01R2\x1dP\t&quot;</span><br><span class="line">b&#x27;s!,!4\x08m5#\x7f,\x1b&amp;\x15\x02\x07\x7f\x0b\x166\x19W\x1dHE\x05.\x14E]&#x27;</span><br><span class="line">b&#x27;!&amp;(1f\x14+t603\x00!\x0f\x06G\x7f\x0b\x06+WQ\x02\t\n\x012UP\x11&#x27;</span><br><span class="line">b&quot;=i4&lt;/\x18%t$7$T&lt;\x04\x11\x04\x7f\x01\x12;W_\x00\x08\x1cR&#x27;U]\x14&quot;</span><br><span class="line">b&quot;6i&#x27;5?[:1p24\x07 A\x07\x02:ES=\x02DN\x11\x16\x07&#x27;\x19]\x04&quot;</span><br><span class="line">b&#x27;7i.5-\x1em&lt;92a\x19;\x13\x06K&gt;\x19\x03-\x12S\x07\x05\x11\x1b0\x10\x11\x12&#x27;</span><br><span class="line">b&#x27;#;&amp;7/\x1a91p7$\x15&amp;\x08\r\x0csI\x1c1\x1bIN\x10\r\x17f\x17]\x14&#x27;</span><br><span class="line">b&#x27;? %1f\x1a#0p65\x07t\x11\x06\x192\x08\x1d:\x19DN\x17\x15\x1b4\x1cE\x08&#x27;</span><br><span class="line">b&#x27;\x1ai+50\x1em;6+$\x1at\x15\x0b\x04*\x0e\x1b+WY\x1aD\x12\x1d3\x19U]&#x27;</span><br><span class="line">b&#x27;s&gt;,!*\x1fm914$T&lt;\x08\x0eK2\x06\x01:WQ\x1e\x14\x17\x17%\x1cP\t&#x27;</span><br><span class="line">b&quot;0;*9/\x15,8#\x7f6\x1c;\x12\x06K,\x19\x1b:\x05UN\x0b\x03R&#x27;\x16E\x14&quot;</span><br><span class="line">b&#x27;?0c5&quot;\x0e! p3(\x121OC/&gt;\x1b\x181\x12C\x1dD\x12\x1d3\x19U]&#x27;</span><br><span class="line">b&#x27;&gt;,1&amp;?\x99\xcd\xc9~\x7f\x03\x01 A\x0e\x04,\x1dS/\x12_\x1e\x08\x00R1\x1aD\x11&#x27;</span><br><span class="line">b&quot;s:+;3\x17)t&#x27;:a\x17&amp;\x0e\x14\x0f\x7f\x00\x1d+\x18\x10\x1a\x0c\n\x01#U]\x1c&quot;</span><br><span class="line">b&quot;200t&#x27;\x0fm&#x27;?2$T \x08\x0e\x0e\x7f\r\x06-\x1e^\tD\r\x1b5UT\x1c&quot;</span><br><span class="line">b&#x27;s&amp;%t5\x12*&lt;$da\x07=\r\x06\x05&lt;\x0cS(\x18E\x02\x00E\x06#\x14R\x15&#x27;</span><br><span class="line">b&#x27;\x00&lt; &lt;f\x089;&quot;6$\x07t\x12\x06\x1f\x7f\x1c\x00\x7f\x03X\x07\n\x0e\x1b(\x12\x1d]&#x27;</span><br><span class="line">b&quot;&#x27; .15[,&#x27;p,)\x1b&amp;\x15C\n,IAkWX\x01\x11\x17\x01hUs\x08&quot;</span><br><span class="line">b&quot;2*682\x12(&#x27;~\x7f\x15\x1c1\x08\x11K:\x10\x16,WQ\x00\x00E\x17&#x27;\x07B]&quot;</span><br><span class="line">b&#x27;2$&amp;t)\x17)t#+.\x06-A\x0c\r\x7f\x07\x1c+WR\x0b\r\x0b\x15f\x12C\x1c&#x27;</span><br><span class="line">b&quot;2;ot5\x14 1$6,\x11&#x27;A\x02\x18\x7f\x1a\x1b0\x05DN\x05\x16RtA\x11\x15&quot;</span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from collections import Counter</span><br><span class="line">from tqdm import *</span><br><span class="line"></span><br><span class="line">with open(&quot;result.log&quot;,&quot;r&quot;) as f:</span><br><span class="line">    f=f.readlines()</span><br><span class="line"># print(f)</span><br><span class="line"></span><br><span class="line">strxor = lambda x,y: bytes([a^b for a,b in zip(x,y)])</span><br><span class="line"></span><br><span class="line">result=[eval(i)for i in f]    # 评估</span><br><span class="line"># print(result)</span><br><span class="line">c=[]</span><br><span class="line">for i in result:</span><br><span class="line">    c.append(strxor(b&#x27;SICTF&#123;&#x27;,i[:6]))</span><br><span class="line"></span><br><span class="line"># 爆破</span><br><span class="line">re=[]</span><br><span class="line">for x in tqdm(c):</span><br><span class="line">    for i in result:</span><br><span class="line">        for j in range(0,len(i)-6):</span><br><span class="line">            tmp=strxor(i[j:j+6],x)</span><br><span class="line">            if len(str(tmp)) == 9:</span><br><span class="line">                re.append(tmp.decode())</span><br><span class="line"># print(re)</span><br><span class="line"></span><br><span class="line"># flag拼接</span><br><span class="line">flag=&#x27;SICTF&#123;&#x27;</span><br><span class="line">for _ in trange(30-7):</span><br><span class="line">    col=[]</span><br><span class="line">    for i in re:</span><br><span class="line">        # print(i[:5])</span><br><span class="line">        if flag[-5:] == i[:5]:</span><br><span class="line">            col.append(i[-1])</span><br><span class="line">    K = Counter(col)</span><br><span class="line">    # print(K)</span><br><span class="line">    flag = flag + K.most_common()[0][0]</span><br><span class="line">    # print(flag)</span><br><span class="line">print(flag+&#x27;&#125;&#x27;)</span><br></pre></td></tr></table></figure>
<h2 id="easy_coppersmith">Easy_CopperSmith</h2>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import flag</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">leak = p &gt;&gt; 230</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(n)</span><br><span class="line">print(leak)</span><br><span class="line">print(c)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span><br><span class="line">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span><br><span class="line">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p>很明显是<span class="math inline">\(P\)</span>高位攻击。但注意的是，当满足以下条件时才能<span class="math inline">\(copper\)</span>, <span class="math display">\[
k=\frac{p未知比特位}{p总比特位}\leq0.44
\]</span> 当不满足这个条件且<span class="math inline">\(k\)</span>与0.44很接近时，<strong>把<span class="math inline">\(f.small_roots(X,beta,epsilon)\)</span>中的<span class="math inline">\(epsilon\)</span>参数改为0.01，即最小的时候，最有可能恢复<span class="math inline">\(p\)</span></strong></p>
<p>在本题中， <span class="math display">\[
k=\frac{230}{512}=0.4492
\]</span> 所以需要设置<span class="math inline">\(epsilon\)</span>参数.</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#sage</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">n = 114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span><br><span class="line">hint = 6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span><br><span class="line">c = 87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">p_high = (hint&lt;&lt;230)</span><br><span class="line"># print(p_high)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = p_high + x</span><br><span class="line">x = f.small_roots(X=2^230, beta=0.4,epsilon=0.01)[0]</span><br><span class="line">p = p_high+int(x)</span><br><span class="line">q = n//p</span><br><span class="line">print(f&quot;p = &#123;p&#125;&quot;)</span><br><span class="line">print(f&quot;q = &#123;q&#125;&quot;)</span><br><span class="line">d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">m = gmpy2.powmod(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="签到题来咯">签到题来咯！</h2>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from  Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">e = getPrime(10)</span><br><span class="line">n = p*q</span><br><span class="line">c1 = pow(114*m+2333,e,n)</span><br><span class="line">c2 = pow(514*m+4555,e,n)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c2&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span><br><span class="line">c1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span><br><span class="line">c2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p>感官上能看出<span class="math inline">\(m1和m2\)</span>存在某种<strong>线性关系</strong>。所以是<strong>相关信息攻击(<span class="math inline">\(Franklin-Reiter\)</span>)</strong></p>
<p>简单来说，相关信息攻击就是<strong>如果两个信息之间存在某种线性关系，并且在相同的<span class="math inline">\(n\)</span>和<span class="math inline">\(e\)</span>下进行<span class="math inline">\(RSA\)</span>加密，那么就有可能恢复出这两个消息</strong>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如果两条消息之间仅存在某种线性关系</span><br><span class="line"></span><br><span class="line">并且在相同的(N,e)下进行RSA加密</span><br><span class="line"></span><br><span class="line">那么就有可能同时恢复它们</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">m2 = a * m1 + b,其中b!=0</span><br><span class="line"></span><br><span class="line">c1 = pow(m1,e,n)</span><br><span class="line"></span><br><span class="line">c2 = pow(m2,e,n)</span><br><span class="line"></span><br><span class="line">其中a,b,c1,c2,e,n都已知，那么m1,m2可被破解</span><br></pre></td></tr></table></figure>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/XiongSiqi_blog/article/details/130978226">Franklin-Reiter相关消息攻击</a></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import binascii</span><br><span class="line">n = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span><br><span class="line">c1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span><br><span class="line">c2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def franklinReiter(n,e,c1,c2):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (114*x+2333)^e - c1</span><br><span class="line">    g2 = (514*x+4555)^e - c2</span><br><span class="line"></span><br><span class="line">    def gcd(g1, g2):</span><br><span class="line">        while g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        return g1.monic()</span><br><span class="line">    return -gcd(g1, g2)[0]</span><br><span class="line"></span><br><span class="line">def get_all_10_bit_primes():</span><br><span class="line">    return [i for i in range(2**9, 2**10) if isPrime(i)]</span><br><span class="line"></span><br><span class="line">e_all = get_all_10_bit_primes()</span><br><span class="line">print(e_all)</span><br><span class="line">for e in e_all:</span><br><span class="line">    m=franklinReiter(n,e,c1,c2)</span><br><span class="line">    flag = long_to_bytes(int(m))</span><br><span class="line">    if b&#x27;SICTF&#x27; in flag:</span><br><span class="line">        print(flag)</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">print(&quot;over&quot;)</span><br><span class="line"># SICTF&#123;hhh!!franklin_reiter_is_easy&#125;</span><br></pre></td></tr></table></figure>
<h2 id="small_e">small_e</h2>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag=&quot;SICTF&#123;&quot;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">e=3</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">m1=((m&gt;&gt;60)&lt;&lt;60)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;,m1)</span><br><span class="line">print(flag)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span><br><span class="line">e= 3</span><br><span class="line">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span><br><span class="line">((m&gt;&gt;60)&lt;&lt;60)= 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p><span class="math inline">\(e=3\)</span>很明显是<strong>低加密指数攻击</strong>，直接上脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span><br><span class="line">e= 3</span><br><span class="line">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span><br><span class="line">k = 0</span><br><span class="line">while 1:</span><br><span class="line">    s = gmpy2.iroot(c+k*n, e)</span><br><span class="line">    if s[1]:</span><br><span class="line">        print(libnum.n2s(int(s[0])))</span><br><span class="line">        break</span><br><span class="line">    k += 1</span><br><span class="line"># SICTF&#123;2ca8e589-4a31-4909-80f0-9ecfc8f8cb37&#125;</span><br></pre></td></tr></table></figure>
<h2 id="easy_math">easy_math</h2>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from  Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">hint1 = getPrime(13)*p+getPrime(256)*q</span><br><span class="line">hint2 = getPrime(13)*p+getPrime(256)*q</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;hint1 = &#123;hint1&#125;&#x27;)</span><br><span class="line">print(f&#x27;hint2 = &#123;hint2&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span><br><span class="line">hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span><br><span class="line">hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span><br><span class="line">c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p>思路：看了题目后，第一反应就是爆破。因为<span class="math inline">\(a_{1},a_{2}\)</span>都是<span class="math inline">\(13bit\)</span>（很小），<span class="math inline">\(b_{1},b_{2}\)</span>都是<span class="math inline">\(256bit\)</span>(很大)，所以这里选择消去<span class="math inline">\(p\)</span>,爆<span class="math inline">\(a_{1},a_{2}\)</span>. <span class="math display">\[
\left\{\begin{matrix}
hint1 = a_{1}*p+b_{1}*q\\
hint2 = a_{2}*p+b_{2}*q
\end{matrix}\right.
\]</span></p>
<p><span class="math display">\[
\Rightarrow a_{2}*hint2-a_{1}*hint2 = (a_{2}*b_{1}-a_{1}*b_{2})*q = k*q
\]</span></p>
<p>参考：<a target="_blank" rel="noopener" href="https://github.com/DownUnderCTF/Challenges_2023_Public/blob/main/crypto/apbq-rsa-i/solve/solv.py">apbq-rsa-i</a></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import itertools</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">from math import gcd</span><br><span class="line"></span><br><span class="line"># n, c, hints</span><br><span class="line">n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span><br><span class="line">hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span><br><span class="line">hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span><br><span class="line">c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span><br><span class="line"></span><br><span class="line">hints = [hint1,hint2]</span><br><span class="line">A = []</span><br><span class="line">for i in range(2**12,2**13):  # 找出13bit的所有素数</span><br><span class="line">    if isPrime(i):</span><br><span class="line">        A.append(i)</span><br><span class="line"></span><br><span class="line"># 爆破</span><br><span class="line">for a1, a2 in tqdm(list(itertools.product(A, repeat=2))):</span><br><span class="line">    kq = gcd(a1 * hints[0] - a2 * hints[1], n)</span><br><span class="line">    if 1 &lt; kq &lt; n:</span><br><span class="line">        print(&#x27;find!&#x27;, kq, a1, a2)</span><br><span class="line">        break</span><br><span class="line">for i in range(2,100):   # 去除因子,求出q</span><br><span class="line">    if kq % i == 0:</span><br><span class="line">        kq //= i</span><br><span class="line">q = kq</span><br><span class="line">p = n // kq</span><br><span class="line">d = pow(0x10001, -1, (p - 1) * (q - 1))</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">flag = long_to_bytes(m).decode()</span><br><span class="line">print(flag)</span><br><span class="line"># SICTF&#123;452aebb6-9c16-441a-ac42-fc608bf6063f&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://hucongting.com">ahu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hucongting.com/2023/09/11/2023-SICTF-Round-2-WP/">https://hucongting.com/2023/09/11/2023-SICTF-Round-2-WP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hucongting.com" target="_blank">yolo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AB%9E%E8%B5%9B/">竞赛</a></div><div class="post_share"><div class="social-share" data-image="https:img/2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/09/13/%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E6%94%BB%E5%87%BB-Franklin-Reiter/" title="相关信息攻击(Franklin-Reiter)"><img class="cover" src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">相关信息攻击(Franklin-Reiter)</div></div></a></div><div class="next-post pull-right"><a href="/2023/09/08/%E4%BA%91%E5%BC%80%E5%8F%91/" title="云开发"><img class="cover" src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">云开发</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/09/04/2023-NSSCTF-%E6%94%B6%E5%BD%95%E9%A2%98/" title="2023 NSSCTF-收录题"><img class="cover" src="/img/loading.gif" data-original="https:img/category_img.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-04</div><div class="title">2023 NSSCTF-收录题</div></div></a></div><div><a href="/2023/08/03/2023DASCTF%E4%B8%83%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B%E5%A4%8D%E7%8E%B0/" title="2023DASCTF七月挑战赛复现"><img class="cover" src="/img/loading.gif" data-original="https:img/2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">2023DASCTF七月挑战赛复现</div></div></a></div><div><a href="/2023/09/04/2023%E8%93%9D%E5%B8%BD%E6%9D%AF/" title="2023蓝帽杯"><img class="cover" src="/img/loading.gif" data-original="https:img/category_img.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-04</div><div class="title">2023蓝帽杯</div></div></a></div><div><a href="/2023/09/04/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/" title="2023羊城杯"><img class="cover" src="/img/loading.gif" data-original="https:img/category_img.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-04</div><div class="title">2023羊城杯</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/nailong.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ahu</div><div class="author-info__description">希望和悲伤都是一缕光，总有一天，我们会再相遇。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/w1i2n3d4"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://githubfast.com/w1i2n3d4" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3235772652@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#radio"><span class="toc-number">1.</span> <span class="toc-text">Radio</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mingtianpao"><span class="toc-number">2.</span> <span class="toc-text">MingTianPao</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy_coppersmith"><span class="toc-number">3.</span> <span class="toc-text">Easy_CopperSmith</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98%E6%9D%A5%E5%92%AF"><span class="toc-number">4.</span> <span class="toc-text">签到题来咯！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#small_e"><span class="toc-number">5.</span> <span class="toc-text">small_e</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy_math"><span class="toc-number">6.</span> <span class="toc-text">easy_math</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/20/%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E9%87%91%E7%A0%962023%E7%BA%BF%E4%B8%8B%E8%B5%9B/" title="一带一路金砖2023线下赛"><img src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一带一路金砖2023线下赛"/></a><div class="content"><a class="title" href="/2023/11/20/%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E9%87%91%E7%A0%962023%E7%BA%BF%E4%B8%8B%E8%B5%9B/" title="一带一路金砖2023线下赛">一带一路金砖2023线下赛</a><time datetime="2023-11-20T01:45:34.000Z" title="发表于 2023-11-20 09:45:34">2023-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/" title="鹏城杯2023-复现"><img src="/img/loading.gif" data-original="https:img/12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="鹏城杯2023-复现"/></a><div class="content"><a class="title" href="/2023/11/14/%E9%B9%8F%E5%9F%8E%E6%9D%AF2023-%E5%A4%8D%E7%8E%B0/" title="鹏城杯2023-复现">鹏城杯2023-复现</a><time datetime="2023-11-14T07:06:55.000Z" title="发表于 2023-11-14 15:06:55">2023-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/01/DAS-CBCTF-2023%E5%A4%8D%E7%8E%B0/" title="DAS-CBCTF 2023复现"><img src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DAS-CBCTF 2023复现"/></a><div class="content"><a class="title" href="/2023/11/01/DAS-CBCTF-2023%E5%A4%8D%E7%8E%B0/" title="DAS-CBCTF 2023复现">DAS-CBCTF 2023复现</a><time datetime="2023-11-01T06:41:32.000Z" title="发表于 2023-11-01 14:41:32">2023-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/28/ACTF-2023-WP/" title="ACTF 2023-WP"><img src="/img/loading.gif" data-original="https:img/category_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ACTF 2023-WP"/></a><div class="content"><a class="title" href="/2023/10/28/ACTF-2023-WP/" title="ACTF 2023-WP">ACTF 2023-WP</a><time datetime="2023-10-28T12:48:32.000Z" title="发表于 2023-10-28 20:48:32">2023-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/19/%E9%9A%8F%E7%AC%94%E5%9B%9B/" title="随笔四"><img src="/img/loading.gif" data-original="https:img/10.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="随笔四"/></a><div class="content"><a class="title" href="/2023/10/19/%E9%9A%8F%E7%AC%94%E5%9B%9B/" title="随笔四">随笔四</a><time datetime="2023-10-19T05:45:23.000Z" title="发表于 2023-10-19 13:45:23">2023-10-19</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https:img/2.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By ahu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>